## Кратко основные термины и команды

### Механизмы Docker:

**Платформа Docker** — ПО, благодаря которому можно работать с контейнерами.
**Движок Docker** — клиент-серверное приложение (CE или Enterprise).
**Клиент Docker** — программа, которая позволяет взаимодействовать с демоном Docker посредством CLI.
**Демон Docker** — сервер Docker, отвечающий за управление ключевыми механизмами системы.
**Тома Docker** — хранилище информации, используемое в контейнерах.
**Реестр Docker** — удалённое хранилище образов.
**Хаб Docker** — самый крупный реестр Docker, используемый по умолчанию.
**Репозиторий** — коллекция образов Docker с одним и тем же именем.

### Объекты:
**Образ** — это шаблон только для чтения с инструкциями по созданию контейнера Docker.
**Dockerfile** — инструкции по созданию образа.
**Контейнер** — это исполняемый экземпляр образа, вызванные к жизни образы Docker.


### Масштабирование:
**Сетевая подсистема Docker** — среда, которая позволяет организовывать взаимодействие контейнеров.
**Docker Compose** — технология, упрощающая работу с многоконтейнерными приложениями.
**Docker Swarm** — средство для управления развёртыванием контейнеров.
**Сервисы Docker** — контейнеры в продакшне.
 
### Инструкции Dockerfile

**FROM** — задаёт базовый (родительский) образ.
**LABEL** — описывает метаданные. Например — сведения о том, кто создал и поддерживает образ.
**ENV** — устанавливает постоянные переменные среды.
**RUN** — выполняет команду и создаёт слой образа. Используется для установки в контейнер пакетов.
**COPY** — копирует в контейнер файлы и папки.
**ADD** — копирует файлы и папки в контейнер, может распаковывать локальные .tar-файлы.
**CMD** — описывает команду с аргументами, которую нужно выполнить когда контейнер будет запущен. Аргументы могут быть переопределены при запуске контейнера. В файле может присутствовать лишь одна инструкция CMD.
**WORKDIR** — задаёт рабочую директорию для следующей инструкции.
**ARG** — задаёт переменные для передачи Docker во время сборки образа.
**ENTRYPOINT** — предоставляет команду с аргументами для вызова во время выполнения контейнера. Аргументы не переопределяются.
**EXPOSE** — указывает на необходимость открыть порт.
**VOLUME** — создаёт точку монтирования для работы с постоянным хранилищем.

### Команды:
#### [Команды для управления образами:](https://docs.docker.com/engine/reference/commandline/image/)
```
docker image my_command
```
**build** — сборка образа. 
```
docker image build -t my_repo/my_image:my_tag .
```
В данном случае создаётся образ с именем my_image, при его сборке используется файл Dockerfile, находящийся по указанному пути или URL. *Флаг -t* — это сокращение для --tag. Он указывает Docker на то, что создаваемому образу надо назначить предоставленный в команде тег. В данном случае это my_tag. Точка в конце команды указывает на то, что образ надо собрать с использованием файла Dockerfile, находящегося в текущей рабочей директории.

**push** — отправка образа в удалённый реестр.
```
docker image push my_repo/my_image:my_tag
```

**ls** — вывод списка образов.
**history** — вывод сведений о слоях образа.
**inspect** — вывод подробной информации об образе, в том числе — сведений о слоях.
**rm** — удаление образа.
Вот команда, которая позволяет удалить все локальные образы:
```
docker image rm $(docker images -a -q) 
```

#### [Команды для управления контейнерами:](https://docs.docker.com/engine/reference/commandline/container/)
```
docker container my_command
```
**[create](https://docs.docker.com/engine/reference/commandline/container_create/)** — создание контейнера из образа. *Флаг -a* представляет собой краткую форму флага --attach. Этот флаг позволяет подключить контейнер к STDIN, STDOUT или STDERR.
**start** — запуск существующего контейнера.
**[run](https://docs.docker.com/engine/reference/commandline/container_run/)** — создание контейнера и его запуск. 
**docker restart** — останавливает и запускает контейнер.
**docker pause** — приостанавливает работающий контейнер.
**docker unpause** — возобновит работу работающего контейнера.
**docker attach** — подключится к запущенному контейнеру.
**rename** - позволяет переименовать контейнер.
**ls** — вывод списка работающих контейнеров. *Ключ -a* этой команды — это сокращение для --all. Благодаря использованию этого ключа можно вывести сведения обо всех контейнерах, а не только о выполняющихся. *Ключ -s* — это сокращение для --size. Он позволяет вывести размеры контейнеров.
**inspect** — вывод подробной информации о контейнере.
**logs** — вывод логов.
**stop** — остановка работающего контейнера с отправкой главному процессу контейнера сигнала SIGTERM, и, через некоторое время, SIGKILL. У контейнера есть, по умолчанию, 10 секунд, на то, чтобы завершить работу.
**kill** — если контейнер нужно остановить быстро, не заботясь о корректном завершении его работы.
Вот команда, которая позволяет быстро остановить все работающие контейнеры:
```
docker container kill $(docker ps -q) 
```
**rm** — удаление остановленного контейнера.
Вот команда, которая позволяет удалить все контейнеры, которые на момент вызова этой команды не выполняются:
```
docker container rm $(docker ps -a -q)
```

Удаление старых контейнеров:
```
docker ps -a | grep 'weeks ago' | awk '{print $1}' | xargs docker rm
```

Удаление остановленных контейнеров:
```
docker rm -v $(docker ps -a -q -f status=exited)
```



#### Разные команды:
**docker images** — показывает все изображения.
**docker import** — создает образ из архива.
**docker commit** — создает образ из контейнера, временно приостанавливая его, если он запущен.
**docker rmi** — удаляет образ.
**docker load** — загружает образ из tar-архива как STDIN, включая изображения и теги (начиная с версии 0.7).
**docker save** — сохраняет изображение в tar-архив поток в STDOUT со всеми родительскими слоями, тегами и версиями (начиная с 0.7).
**docker version** — вывод сведений о версиях клиента и сервера Docker.
**docker login** — вход в реестр Docker.
**docker system prune** — удаление неиспользуемых контейнеров, сетей и образов, которым не назначено имя и тег.

#### Команды при работе с томами:

**```docker volume create```** — создание тома
**```docker volume ls```** — список томов
Исследовать конкретный том можно так:
```
docker volume inspect my_volume
```

**```docker volume rm```** — удалить том
Для того чтобы удалить все тома, которые не используются контейнерами:
```
docker volume prune 
```
Если это случилось — можете воспользоваться следующей командой:
```
docker system prune
```
Она предназначена для очистки ресурсов Docker.
